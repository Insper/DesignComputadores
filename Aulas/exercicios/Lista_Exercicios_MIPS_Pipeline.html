<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Lista_Exercicios_MIPS_Pipeline</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style>
  /* fundo para o trecho de código */
  div.sourceCode { overflow-x: auto; background-color: rgb(245,245,245);}  /*rgb(250,250,250)*/
  body {font-family: "Lato", sans-serif;}
  
  /* Para dividir a pagina em duas colunas */
   .column {
    float: left;
    width:49%;
    justify-content: center;
    align-items: center;
  }
  
  /* Clear floats after the columns */
  .row:after {
    content: "";
    display: table;
    clear: both;
  }
  
  /* Inicio do menu tipo acordeon */
  .accordion{
    background-color: #eee;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    transition: 0.4s;
    font-weight: bold;
  }
  .active, .accordion:hover {
    background-color: #a4b8b6;
  }
  .panel {
    /*Versao anterior do accordion usa  max-height: 0 para fazer a transition e nao aceita aninhamento de acordeon*/
    padding: 0 10px;
    background-color: #f9f9f9;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
    margin-left: 0%;
  }
  .panel p {
    margin-left: 1%;
  }
  /*Inicio do Acordeon Aninhado*/
  button.accordionNested{
    background-color: #eee;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    font-weight: bold;
  }
  .activeNested, .accordionNested:hover {
    background-color: #a4b8b6;
  }
  .panelNested {
    /*Aceita aninhamento mas nao faz transition*/
    padding: 0 10px;
    background-color: #f9f9f9;
    display: none;
    overflow: hidden;
    margin-left: 0%;
  }
  .panelNested p {
    margin-left: 1%;
  }
  /*Inicio do Segundo Acordeon Aninhado*/
  button.accordionNestedTwo{
    background-color: #eee;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    font-weight: bold;
  }
  .activeNestedTwo, .accordionNestedTwo:hover {
    background-color: #a4b8b6;
  }
  .panelNestedTwo {
    /*Aceita aninhamento mas nao faz transition*/
    padding: 0 10px;
    background-color: #f9f9f9;
    display: none;
    overflow: hidden;
    margin-left: 0%;
  }
  .panelNestedTwo p {
    margin-left: 1%;
  }
  /* Fim do menu tipo acordeon */
  
  .bloco .title {
      display: block;
  }
  
  /*Bloco de solucao de exercicio*/
  .bloco .label,
  .bloco .separator {
      font-weight: bold;
  }
  
  .bloco .separator {
      margin-right: .6em;
  /*    margin-left: .6em;  */
  }
  
  /* Quiz Participacao */
  div.quiz {
    padding: 1rem;
    width: 600px;
    box-shadow: 0 15px 30px 0 rgba(0,0,0,0.11),
      0 5px 15px 0 rgba(0,0,0,0.08);
    background-color: #ffffff;
    border-radius: 0.5rem;
    border-left: 0 solid #00ff99;
    font-weight:bold;
    color:#bf360c;
  }
  
  /* Solução */
  div.solucao {
    border-left: .3em solid #dd4444;   /*#dc3c01; */
    margin-left: -.8em;
    padding-left: .4em;
    position: relative;
    font-size: 90%;
  }
  
  div.solucao .conteudo {
    display: none;
    padding-top: 1px;
  }
  
  div.solucao button {
    color: #0000AF;
    background-color: white;
    border-radius: 5px;
  }
  
  div.solucao button.viewed {
    color: #FF2020;
    background-color: white;
    border-radius: 5px;
  }
  
  div.exemplo {
    /*background-color: lightgray;*/
    margin-left: 5%;
    margin-right: 5%;
  }
  
  div.exemplo .sourceCode  {
    /*background-color: lightgray;*/
    margin-left: 2%;
    margin-right: 2%;
  }
  
  div.adicional {
    margin-left: 1%;
  }
  /* Alinhamento dos títulos e parágrafos */
  
  body{margin-left: 5%; margin-right: 5%;
           color: black; background-color: #f9f9f9;}
  
  hr{
      margin-left: -4%;
      background-color: rgb(0,150,150);  /*anterior:    240,240,240 */
  }
  h1{
      margin-left: -4%;
      /*background-color: rgb(210,210,220);*/
  }
  
  h2{
      margin-left: -4%;
      /*background-color: rgb(220,220,230);*/
  }
  
  h3{
      margin-left: 0%;  /*-4%;*/
      /*background-color: rgb(230,230,240);*/
  }
  
  h4{
      margin-left: 0%;  /*-4%;*/
      /*background-color: rgb(240,240,250);*/
  }
  h5{
      margin-left: 0%;  /*-4%;*/
      /*background-color: rgb(245,245,250);*/
  }
  
  /* Cores */
  i{color: red}
  em{color: green}
  cite{color: brown}
  /* blockquote > p { */
  blockquote{color: red}
  blockquote p {
    margin-bottom: 0;
    font-size: 14px;
    font-weight: 300;
    line-height: 2em;
  }
  
  /* ---- Front Matter ----
  Pandoc header DIV. Contains .title, .author and .date. Comes before div#TOC.
  Only appears if one of those three are in the document.   */
  
  div#header, header
      {
      /* Put border on bottom. Separates it from TOC or body that comes after it. */
      border-bottom: 1px solid #aaa;
      margin-bottom: 0.5em;
      }
  
  .title /* Pandoc title header (h1.title) */
      {
      text-align: center;
      }
  
  .author, .date /* Pandoc author(s) and date headers (h2.author and h3.date) */
      {
      text-align: center;
      }
  
  /* Pandoc table of contents DIV when using the --toc option.
     NOTE: this doesn't support Pandoc's --id-prefix option for #TOC and #header.
     Probably would need to use div[id$='TOC'] and div[id$='header'] as selectors.
  */
  
  div#TOC, nav#TOC
      {
      /* Put border on bottom to separate it from body. */
  /*    border-bottom: 1px solid #aaa;   */
      margin-bottom: 0.5em;
      }
  
  @media print
      {
      div#TOC, nav#TOC
          {
          /* Don't display TOC in print */
          display: none;
          }
      }
  /* ---- Images ---- */
  img {
      /* Let it be inline left/right where it wants to be, but verticality make
         it in the middle to look nicer, but opinions differ, and if in a multi-line
         paragraph, it might not be so great.
         vertical-align: middle;
      */
      vertical-align: middle;
      max-width: 600px;
      height:auto;
      }
  div.figure /* Pandoc figure-style image */
      {
      /* Center the image and caption */
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      font-style: italic;
      max-width: 600px;
      height:auto;
      }
  p.caption /* Pandoc figure-style caption within div.figure */
      {
      /* Inherits div.figure props by default */
      }
  /* ---- Tables ---- */
  table {
      margin-left: auto;
      margin-right: auto;
      margin-bottom: 24px;
      border-spacing: 0;
      border-bottom: 2px solid black;
      border-top: 2px solid black;
  }
  table th {
      padding: 3px 10px;
      background-color: white;
      border-top: 1px;
      border-left: 1px;
      border-right: 1px;
      border-bottom: 1px solid black;
  }
  table td {
      padding: 3px 10px;
      border-top: 1px;
      border-left: 1px;
      border-bottom: 1px;
      border-right: 1px;
  }
  /* fundo para as linhas das tabelas */
  tr.even{
    background-color: rgb(230,230,240);
  }
  tr.odd{
    background-color: rgb(250,250,250);
  }
  </style>
  
  
  <script type="text/javascript">
      function exibe(e)
      {
          var div = e.parentNode.firstElementChild;
          var nome = e.parentNode.id;
          var tipo=nome.substring(0, 3).toUpperCase()
          switch (tipo) {
            case "SOL":
                nome = "Solução";
                break;
            case "COD":
                nome = "Código";
                break;
            case "DIC":
                nome = "Dica";
                break;
            case "DIA":
                nome = "Diagrama";
                break;
            case "RES":
                nome = "Resumo";
                break;
            case "CON":
                nome = "Conteúdo";
                break;
            default:
                nome = "";
            }
  
          if (div.style.display == "" || div.style.display == "none") {
              div.style.display = "block";
              e.setAttribute("class", "viewed");
              e.innerHTML = "Esconder ";
          } else {
              div.style.display = "none";
              e.innerHTML = "Exibir "+nome;
          }
      }
      function validaBinario(nome) {
          var valor, tamanho, i;
          document.getElementById(nome).style.color = "black";
          valor = document.getElementById(nome).value;
          tamanho=valor.length;
          for (i=0;i<tamanho; i=i+1){
              if ( valor[i] != 1 && valor[i] != 0 ){
                  document.getElementById(nome).style.color = "red";
              }
          }
      }
  </script>
</head>
<body>
<p><a name="inicio"></a></p>
<h1 id="lista-de-exercícios-sobre-mips-com-pipeline">Lista de Exercícios sobre MIPS com Pipeline</h1>
<button class="accordion">
Exercício 1: Execução no Pipeline
</button>
<div class="panel">
<p><strong>Ex 7.28 DDCA 2 Ed</strong></p>
<p>O programa abaixo está executando no MIPS com pipeline (com controle de Hazards).</p>
<p>Quais registradores são escritos e quais são lidos no quinto ciclo de clock?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb1-1" title="1">addi <span class="dv">$</span>s1, <span class="dv">$</span>s2, <span class="dv">5</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="bu">sub</span> <span class="dv">$</span>t0, <span class="dv">$</span>t1, <span class="dv">$</span>t2</a>
<a class="sourceLine" id="cb1-3" title="3">lw <span class="dv">$</span>t3, <span class="dv">15</span>(<span class="dv">$</span>s1)</a>
<a class="sourceLine" id="cb1-4" title="4">sw <span class="dv">$</span>t5, <span class="dv">72</span>(<span class="dv">$</span>t0)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="bu">or</span> <span class="dv">$</span>t2, <span class="dv">$</span>s4, <span class="dv">$</span>s5</a></code></pre></div>
<figure>
<img src="imagens/pipelineSimplificadoWiki-3.svg" alt="Execução no Pipeline" style="width:800px;max-width:100%;" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Escrito: $s1</p>
<p>Lido: $t0 e $t5</p>
<p><br></p>
</div>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 2: Execução no Pipeline
</button>
<div class="panel">
<p><strong>Ex 7.29 DDCA 2 Ed</strong></p>
<p>O programa abaixo está executando no MIPS com pipeline (com controle de Hazards).</p>
<p>Quais registradores são escritos e quais são lidos no quinto ciclo de clock?</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb2-1" title="1"><span class="bu">add</span> <span class="dv">$</span>s0, <span class="dv">$</span>t0, <span class="dv">$</span>t1</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="bu">sub</span> <span class="dv">$</span>s1, <span class="dv">$</span>t2, <span class="dv">$</span>t3</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="bu">and</span> <span class="dv">$</span>s2, <span class="dv">$</span>s0, <span class="dv">$</span>s1</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="bu">or</span> <span class="dv">$</span>s3, <span class="dv">$</span>t4, <span class="dv">$</span>t5</a>
<a class="sourceLine" id="cb2-5" title="5">slt <span class="dv">$</span>s4, <span class="dv">$</span>s2, <span class="dv">$</span>s3</a></code></pre></div>
<figure>
<img src="imagens/pipelineSimplificadoWiki-3.svg" alt="Execução no Pipeline" style="width:800px;max-width:100%;" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Escrito: $s0</p>
<p>Lido: $t4 e $t5</p>
</div>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 3: Forwarding e Stall
</button>
<div class="panel">
<p><strong>Ex 7.30 DDCA 2 Ed</strong></p>
<p>Mostre as ocorrências de forwarding e stalls, do código abaixo, se executado no MIPS com pipeline.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb3-1" title="1"><span class="bu">add</span> <span class="dv">$</span>t0, <span class="dv">$</span>s0, <span class="dv">$</span>s1</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="bu">sub</span> <span class="dv">$</span>t0, <span class="dv">$</span>t0, <span class="dv">$</span>s2</a>
<a class="sourceLine" id="cb3-3" title="3">lw <span class="dv">$</span>t1, <span class="dv">60</span>(<span class="dv">$</span>t0)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="bu">and</span> <span class="dv">$</span>t2, <span class="dv">$</span>t1, <span class="dv">$</span>t0</a></code></pre></div>
<figure>
<img src="imagens/pipelineSimplificadoWiki-3.svg" alt="Execução no Pipeline" style="width:800px;max-width:100%;" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<figure>
<img src="imagens/DDCA-2Ed-Ex-7_30.png" alt="Execução no Pipeline" style="width:800px" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 4: Forwarding e Stall
</button>
<div class="panel">
<p><strong>Ex 7.31 DDCA 2 Ed</strong></p>
<p>Mostre as ocorrências de forwarding e stalls, do código abaixo, se executado no MIPS com pipeline.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb4-1" title="1"><span class="bu">add</span> <span class="dv">$</span>t0, <span class="dv">$</span>s0, <span class="dv">$</span>s1</a>
<a class="sourceLine" id="cb4-2" title="2">lw <span class="dv">$</span>t1, <span class="dv">60</span>(<span class="dv">$</span>s2)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="bu">sub</span> <span class="dv">$</span>t2, <span class="dv">$</span>t0, <span class="dv">$</span>s3</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="bu">and</span> <span class="dv">$</span>t3, <span class="dv">$</span>t1, <span class="dv">$</span>t0</a></code></pre></div>
<figure>
<img src="imagens/pipelineSimplificadoWiki-3.svg" alt="Execução no Pipeline" style="width:800px;max-width:100%;" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<figure>
<img src="imagens/DDCA-2Ed-Ex-7_31.png" alt="Execução no Pipeline" style="width:800px" /><figcaption><strong>Execução no Pipeline</strong></figcaption>
</figure>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 5: Tempo de Execução no Pipeline
</button>
<div class="panel">
<p><strong>Ex 7.32 DDCA 2 Ed</strong></p>
<p>Quantos ciclos de “clock” são necessários para que o MIPS, com pipeline, execute todas as instruções do programa abaixo?</p>
<blockquote>
<p>Recursos do MIPS: <em>forwarding</em>, execução do BEQ no segundo estágio, <em>stall</em> gerado por hardware.</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb5-1" title="1">    addi <span class="dv">$</span>s0<span class="bn">, $0, </span><span class="dv">5</span>     # resultado=<span class="dv">5</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="pp">WHILE</span>:</a>
<a class="sourceLine" id="cb5-3" title="3">    beq <span class="dv">$</span>s0<span class="bn">, $0, </span>FIM      # se resultado &gt; <span class="dv">0</span>, executa o bloco “WHILE”</a>
<a class="sourceLine" id="cb5-4" title="4">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">-1</span>     # bloco “while”: resultado = resultado - <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-5" title="5">    j <span class="pp">WHILE</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="fu">FIM:</span></a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>O código é executado em 23 ciclos de “clock”:</p>
<pre><code>1 (addi) + 5(laços)*4(beq+addi+jump+stall) + 2 (beq+stall) = 23.</code></pre>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 6: Tempo de Execução no Pipeline
</button>
<div class="panel">
<p><strong>Ex 7.33 DDCA 2 Ed</strong></p>
<p>Quantos ciclos de “clock” são necessários para que o MIPS com pipeline execute todas as instruções do programa abaixo?</p>
<blockquote>
<p>Recursos do MIPS: <em>forwarding</em>, execução do BEQ no segundo estágio, <em>stall</em> gerado por hardware.</p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb7-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0       </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, $0       </span># soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb7-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>      # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb7-5" title="5">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0     # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb7-6" title="6">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM      # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb7-7" title="7">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0     # soma = soma + i</a>
<a class="sourceLine" id="cb7-8" title="8">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>      # incrementa i</a>
<a class="sourceLine" id="cb7-9" title="9">    j <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="fu">FIM:</span></a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Só é necessário adicionar o ciclo de <em>stall</em> depois do <em>Jump</em> e do <em>BEQ</em>.</p>
<p>O código é executado em 66 ciclos de “clock”:</p>
<pre><code>3(add+add+addi) + 6(slt+beq+add+addi+jump+stall)*10(laços) + 3(slt+beq+stall) = 66.</code></pre>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 7: Vantagens do Pipeline
</button>
<div class="panel">
<p><strong>Questão 7.1 DDCA 2 Ed – pg 473</strong></p>
<p>Explique as vantagens de um microprocessador com pipeline.</p>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Um microprocessador com pipeline de N estágios, terá um ganho “ideal” de velocidade de N vezes sobre o mesmo microprocessador com execução em um único ciclo.</p>
<p>O ganho não será de N vezes em função de:</p>
<ul>
<li><p>A adição de registradores entre os estágios, adiciona o tempo de propagação deles ao tempo total do pipeline.</p></li>
<li><p>Não são todas as instruções que utilizam todos os estágios do pipeline. Em função disso, existem ciclos sem trabalho útil em algum estágio do pipeline.</p></li>
</ul>
<p>Porém, o custo adicional não é tão grande. Ele envolve alguns registradores (fronteira entre as etapas), MUX para fazer o forwarding e as unidades de controle específicas para o pipeline.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 8: Dependência de Dados
</button>
<div class="panel">
<p><strong>COD 4Ed Ex. 4.20</strong></p>
<p>Para os dois trechos de código abaixo, pede-se:</p>
<ol type="a">
<li><p>Mostrar as dependências existentes;</p></li>
<li><p>Para um pipeline com 5 estágios, sem forwarding e sem stall, mostre todos os hazards existentes;</p></li>
<li><p>Para um pipeline com 5 estágios, com forwarding e sem stall, mostre todos os hazards existentes.</p></li>
</ol>
<p>Trecho 1:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb9-1" title="1"><span class="bu">add</span> R1, R2, R1</a>
<a class="sourceLine" id="cb9-2" title="2">lw R2, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb9-3" title="3">lw R1, <span class="dv">4</span>(R1)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="bu">or</span> R3, R1, R2</a></code></pre></div>
<p>Trecho 2:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb10-1" title="1">lw R1, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="bu">and</span> R1, R1, R2</a>
<a class="sourceLine" id="cb10-3" title="3">lw R2, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb10-4" title="4">lw R1, <span class="dv">0</span>(R3)</a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p><strong>Solução do item A:</strong></p>
<p>Dependências estão na mesma cor e em negrito:</p>
<table>
<caption><strong>Trecho 1</strong></caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">add <font style="color:red"><strong>R1</strong></font>, R2, R1</td>
</tr>
<tr class="even">
<td style="text-align: left;">lw <font style="color:blue"><strong>R2</strong></font>, 0(<font style="color:red"><strong>R1</strong></font>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lw <font style="color:green"><strong>R1</strong></font>, 4(<font style="color:red"><strong>R1</strong></font>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">or R3, <font style="color:green"><strong>R1</strong></font>, <font style="color:blue"><strong>R2</strong></font></td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Trecho 2</strong></caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">lw <font style="color:red"><strong>R1</strong></font>, 0(R1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">and <font style="color:blue"><strong>R1</strong></font>, <font style="color:red"><strong>R1</strong></font>, R2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lw R2, 0(<font style="color:blue"><strong>R1</strong></font>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">lw R1, 0(R3)</td>
</tr>
</tbody>
</table>
<p><strong>Solução do item B:</strong></p>
<p>Pipelilne com 5 estágios, <strong>sem</strong> <em>forwarding</em> e <strong>sem</strong> <em>stall</em>:</p>
<ul>
<li>Todas dependências mostradas, no item A, causam hazards.</li>
</ul>
<p><strong>Solução do item C:</strong></p>
<p>Pipelilne com 5 estágios, <strong>com</strong> <em>forwarding</em> e <strong>sem</strong> <em>stall</em>:</p>
<ul>
<li>Somente as dependências entre <em>lw</em> e uma leitura na <strong>próxima</strong> instrução, causam hazards.</li>
</ul>
<table>
<caption><strong>Trecho 1</strong></caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">add R1, R2, R1</td>
</tr>
<tr class="even">
<td style="text-align: left;">lw R2, 0(R1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lw <font style="color:green"><strong>R1</strong></font>, 4(R1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">or R3, <font style="color:green"><strong>R1</strong></font>, R2</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Trecho 2</strong></caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">lw <font style="color:red"><strong>R1</strong></font>, 0(R1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">and R1, <font style="color:red"><strong>R1</strong></font>, R2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lw R2, 0(R1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">lw R1, 0(R3)</td>
</tr>
</tbody>
</table>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 9: Execução Correta
</button>
<div class="panel">
<p><strong>COD 4Ed Ex. 4.21</strong></p>
<p>Para os dois trechos de código abaixo, pede-se:</p>
<ol type="a">
<li><p>Insira os NOPs necessários para uma execução correta;</p></li>
<li><p>Rearranje as instruções para obter a menor quantidade de NOPs.</p></li>
</ol>
<p>Trecho 1:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb11-1" title="1"><span class="bu">add</span> R5, R2, R1</a>
<a class="sourceLine" id="cb11-2" title="2">lw R3, <span class="dv">4</span>(R5)</a>
<a class="sourceLine" id="cb11-3" title="3">lw R2, <span class="dv">0</span>(R2)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="bu">or</span> R3, R5, R3</a>
<a class="sourceLine" id="cb11-5" title="5">sw R3, <span class="dv">0</span>(R5)</a></code></pre></div>
<p>Trecho 2:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb12-1" title="1">lw R2, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="bu">and</span> R1, R2, R1</a>
<a class="sourceLine" id="cb12-3" title="3">lw R3, <span class="dv">0</span>(R2)</a>
<a class="sourceLine" id="cb12-4" title="4">lw R1, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb12-5" title="5">sw R1, <span class="dv">0</span>(R2)</a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p><strong>Solução item A:</strong></p>
<p>Trecho 1:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb13-1" title="1"><span class="bu">add</span> R5, R2, R1</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb13-4" title="4">lw R3, <span class="dv">4</span>(R5)</a>
<a class="sourceLine" id="cb13-5" title="5">lw R2, <span class="dv">0</span>(R2)</a>
<a class="sourceLine" id="cb13-6" title="6"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="bu">or</span> R3, R5, R3</a>
<a class="sourceLine" id="cb13-8" title="8"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb13-10" title="10">sw R3, <span class="dv">0</span>(R5)</a></code></pre></div>
<p>Trecho 2:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb14-1" title="1">lw R2, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="bu">and</span> R1, R2, R1</a>
<a class="sourceLine" id="cb14-5" title="5">lw R3, <span class="dv">0</span>(R2)</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb14-7" title="7">lw R1, <span class="dv">0</span>(R1)</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb14-10" title="10">sw R1, <span class="dv">0</span>(R2)</a></code></pre></div>
<p><strong>Solução item B:</strong></p>
<p>Trecho 1, sem ganho de desempenho:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb15-1" title="1"><span class="bu">add</span> R5, R2, R1</a>
<a class="sourceLine" id="cb15-2" title="2">lw R2, <span class="dv">0</span>(R2)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb15-4" title="4">lw R3, <span class="dv">4</span>(R5)</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="bu">or</span> R3, R5, R3</a>
<a class="sourceLine" id="cb15-8" title="8"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="bu">nop</span></a>
<a class="sourceLine" id="cb15-10" title="10">sw R3, <span class="dv">0</span>(R5)</a></code></pre></div>
<p>Trecho 2: não tem como mudar a sequência sem adicionar nops.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 10: Dependência de Dados
</button>
<div class="panel">
<p>Para o trecho de código abaixo, executando no MIPS com pipeline, pergunta-se:</p>
<ol type="a">
<li><p>Existe algum tipo de dependência entre as instruções?</p></li>
<li><p>Caso sim, essa condição se refere ao tempo de execução ou compilação? (justifique)</p></li>
<li><p>Caso não, justifique a sua resposta.</p></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb16-1" title="1">sw<span class="bn"> $3, </span><span class="dv">0</span>(<span class="dv">$2</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">lw<span class="bn"> $4, </span><span class="dv">0</span>(<span class="dv">$5</span>)</a></code></pre></div>
<table>
<caption><strong>Execução</strong></caption>
<thead>
<tr class="header">
<th style="text-align: center;">instrução / clock</th>
<th style="text-align: center;">01</th>
<th style="text-align: center;">02</th>
<th style="text-align: center;">03</th>
<th style="text-align: center;">04</th>
<th style="text-align: center;">05</th>
<th style="text-align: center;">06</th>
<th style="text-align: center;">07</th>
<th style="text-align: center;">08</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">sw $3, 0($2)</td>
<td style="text-align: center;">IF</td>
<td style="text-align: center;">ID</td>
<td style="text-align: center;">EX</td>
<td style="text-align: center;">MEM</td>
<td style="text-align: center;">WB</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">lw $4, 0($5)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">IF</td>
<td style="text-align: center;">ID</td>
<td style="text-align: center;">EX</td>
<td style="text-align: center;">MEM</td>
<td style="text-align: center;">WB</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Não existe dependência.</p>
<p>A dependência que pode gerar problemas é a de leitura depois da escrita (RAW) no banco de registradores.</p>
<p>Neste caso, como a instrução <em>sw</em> faz uma leitura do banco de registradores, mesmo se o <em>lw</em> usasse o mesmo registrador, teríamos uma escrita após leitura (WAR) que não gera hazards.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 11: Tempo de Execução no Pipeline somente com Forwarding
</button>
<div class="panel">
<p><strong>Variação sobre o Ex 7.33 DDCA 2 Ed</strong></p>
<p>Quantos ciclos de “clock” são necessários para que o MIPS com pipeline execute todas as instruções do programa abaixo?</p>
<blockquote>
<p>Recursos do MIPS: <em>forwarding</em>, execução do BEQ no <strong>quarto</strong> estágio, <strong>sem</strong> <em>stall</em> gerado por hardware.</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb17-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0       </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb17-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, $0       </span># soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb17-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>      # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb17-5" title="5">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0     # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb17-6" title="6">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM      # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0     # soma = soma + i</a>
<a class="sourceLine" id="cb17-8" title="8">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>      # incrementa i</a>
<a class="sourceLine" id="cb17-9" title="9">    j <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="fu">FIM:</span></a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Para a execução, somente com bypass, deve-se adicionar os seguintes NOPS para os casos de hazard de controle:</p>
<ul>
<li><p>Três NOPS depois do BEQ, para evitar a execução de instruções indevidas na ocorrência do desvio do BEQ;</p></li>
<li><p>Um NOP depois do Jump, para evitar a execução de instruções indevidas.</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb18-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0        </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb18-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, $0        </span># soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb18-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>       # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb18-5" title="5">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0      # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb18-6" title="6">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM       # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb18-7" title="7">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb18-8" title="8">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb18-9" title="9">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb18-10" title="10">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0      # soma = soma + i</a>
<a class="sourceLine" id="cb18-11" title="11">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>       # incrementa i</a>
<a class="sourceLine" id="cb18-12" title="12">    j   <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb18-13" title="13">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="fu">FIM:</span></a></code></pre></div>
<p><strong>Solução:</strong></p>
<p>A etapa inicial do código consome:</p>
<p>add+add+addi = 3</p>
<p>A etapa relativa ao laço, que executa 10 vezes, consome:</p>
<p>9(slt+beq+nop+nop+nop+add+addi+jump+nop)*10(laços) = 90</p>
<p>A saída do laço, consome:</p>
<p>slt+beq+nop+nop+nop = 5.</p>
<p>Total (3+90+5) = 98 ciclos de clock.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 12: Tempo de Execução no Pipeline Simples
</button>
<div class="panel">
<p><strong>Variação sobre o Ex 7.33 DDCA 2 Ed</strong></p>
<p>Quantos ciclos de “clock” são necessários para que o MIPS com pipeline execute todas as instruções do programa abaixo?</p>
<blockquote>
<p>Recursos do MIPS: <strong>sem</strong> <em>forwarding</em>, execução do BEQ no <strong>quarto</strong> estágio, <strong>sem</strong> <em>stall</em> gerado por hardware.</p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb19-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0       </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb19-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, $0       </span># soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>      # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb19-5" title="5">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0     # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-6" title="6">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM      # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb19-7" title="7">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0     # soma = soma + i</a>
<a class="sourceLine" id="cb19-8" title="8">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>      # incrementa i</a>
<a class="sourceLine" id="cb19-9" title="9">    j <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="fu">FIM:</span></a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Para a execução, no Pipeline Simples, deve-se adicionar os seguintes NOPS:</p>
<ul>
<li><p>Três NOPS depois do BEQ, para evitar a execução de instruções indevidas na ocorrência do desvio do BEQ;</p></li>
<li><p>Um NOP depois do Jump, para evitar a execução de instruções indevidas.</p></li>
<li><p>Dois NOPS depois de cada instrução com dependência de dados.</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb20-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0        </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb20-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, $0        </span># soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>       # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb20-4" title="4">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-5" title="5">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb20-7" title="7">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0      # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-8" title="8">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-9" title="9">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-10" title="10">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM       # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb20-11" title="11">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-12" title="12">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-13" title="13">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-14" title="14">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0      # soma = soma + i</a>
<a class="sourceLine" id="cb20-15" title="15">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>       # incrementa i</a>
<a class="sourceLine" id="cb20-16" title="16">    j   <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb20-17" title="17">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb20-18" title="18"><span class="fu">FIM:</span></a></code></pre></div>
<p><strong>Solução:</strong></p>
<p>A etapa inicial do código consome:</p>
<p>add+add+addi+nop+nop = 5</p>
<p>A etapa relativa ao laço, que executa 10 vezes, consome:</p>
<p>11(slt+nop+nop+beq+nop+nop+nop+add+addi+jump+nop)*10(laços) = 110</p>
<p>A saída do laço, consome:</p>
<p>slt+nop+nop+beq+nop+nop+nop = 7.</p>
<p>Total (5+110+7) = 122 ciclos de clock.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 13: Tempo de Execução no Pipeline Simples
</button>
<div class="panel">
<p><strong>Variação sobre o Ex 7.33 DDCA 2 Ed</strong></p>
<p>Quantos ciclos de “clock” são necessários para que o MIPS com pipeline execute todas as instruções do programa abaixo?</p>
<blockquote>
<p>Recursos do MIPS: <strong>sem</strong> <em>forwarding</em>, execução do BEQ no <strong>quarto</strong> estágio, <strong>sem</strong> <em>stall</em> gerado por hardware.</p>
</blockquote>
<div class="sourceCode" id="cb21"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb21-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0       </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb21-2" title="2">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, </span><span class="dv">$</span>s0       # soma = <span class="dv">0</span></a>
<a class="sourceLine" id="cb21-3" title="3">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>      # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb21-5" title="5">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0     # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb21-6" title="6">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM      # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb21-7" title="7">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0     # soma = soma + i</a>
<a class="sourceLine" id="cb21-8" title="8">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>      # incrementa i</a>
<a class="sourceLine" id="cb21-9" title="9">    j <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="fu">FIM:</span></a></code></pre></div>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Para a execução, no Pipeline Simples, deve-se adicionar os seguintes NOPS:</p>
<ul>
<li><p>Três NOPS depois do BEQ, para evitar a execução de instruções indevidas na ocorrência do desvio do BEQ;</p></li>
<li><p>Um NOP depois do Jump, para evitar a execução de instruções indevidas.</p></li>
<li><p>Dois NOPS depois de cada instrução com dependência de dados.</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode asm"><code class="sourceCode fasm"><a class="sourceLine" id="cb22-1" title="1">    <span class="bu">add</span> <span class="dv">$</span>s0<span class="bn">, $0, $0        </span># i=<span class="dv">0</span></a>
<a class="sourceLine" id="cb22-2" title="2">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="bu">add</span> <span class="dv">$</span>s1<span class="bn">, $0, </span><span class="dv">$</span>s0      # soma = <span class="dv">0</span>  dependência em <span class="dv">$</span>s0</a>
<a class="sourceLine" id="cb22-5" title="5">    addi <span class="dv">$</span>t0<span class="bn">, $0, </span><span class="dv">10</span>       # <span class="dv">$</span>t0 = <span class="dv">10</span></a>
<a class="sourceLine" id="cb22-6" title="6">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-7" title="7">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="bu">LOOP</span>:</a>
<a class="sourceLine" id="cb22-9" title="9">    slt <span class="dv">$</span>t1, <span class="dv">$</span>s0, <span class="dv">$</span>t0      # <span class="pp">if</span> (i &lt; <span class="dv">10</span>), <span class="dv">$</span>t1 = <span class="dv">1</span>, <span class="pp">else</span> <span class="dv">$</span>t1 = <span class="dv">0</span></a>
<a class="sourceLine" id="cb22-10" title="10">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-11" title="11">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-12" title="12">    beq <span class="dv">$</span>t1<span class="bn">, $0, </span>FIM       # <span class="pp">if</span> <span class="dv">$</span>t1 == <span class="dv">0</span> (i &gt; = <span class="dv">10</span>), desvia para o FIM</a>
<a class="sourceLine" id="cb22-13" title="13">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-14" title="14">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-15" title="15">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-16" title="16">    <span class="bu">add</span> <span class="dv">$</span>s1, <span class="dv">$</span>s1, <span class="dv">$</span>s0      # soma = soma + i</a>
<a class="sourceLine" id="cb22-17" title="17">    addi <span class="dv">$</span>s0, <span class="dv">$</span>s0, <span class="dv">1</span>       # incrementa i</a>
<a class="sourceLine" id="cb22-18" title="18">    j   <span class="bu">LOOP</span></a>
<a class="sourceLine" id="cb22-19" title="19">    <span class="bu">nop</span></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="fu">FIM:</span></a></code></pre></div>
<p><strong>Solução:</strong></p>
<p>A etapa inicial do código consome:</p>
<p>add+nop+nop+add+addi+nop+nop = 7</p>
<p>A etapa relativa ao laço, que executa 10 vezes, consome:</p>
<p>11(slt+nop+nop+beq+nop+nop+nop+add+addi+jump+nop)*10(laços) = 110</p>
<p>A saída do laço, consome:</p>
<p>slt+nop+nop+beq+nop+nop+nop = 7.</p>
<p>Total (7+110+7) = 124 ciclos de clock.</p>
</div>
<!--- class_panel --->
<hr />
<button class="accordion">
Exercício 14: Execução de JAL e JR no Pipeline
</button>
<div class="panel">
<p>Considerando o pipeline simples, a instrução JAL, que é do tipo J, e trabalha em conjunto com a instrução JR, em princípio, pode ser executada nos seguintes estágios:</p>
<ul>
<li><p>Estágio ID (decodificação);</p></li>
<li><p>Estágio EX (execução);</p></li>
<li><p>Estágio MEM (leitura/escrita na memória);</p></li>
<li><p>Estágio WB (escrita no banco de registradores).</p></li>
</ul>
<figure>
<img src="../imagensMIPS/esquemaPipeline-2.png" alt="Esquema de Pipeline do MIPS" style="width:800px;max-width:100%;" /><figcaption><strong>Esquema de Pipeline do MIPS</strong></figcaption>
</figure>
<p>Para esses casos, quais das afirmações mostradas abaixo são corretas?</p>
<p>1 - A execução, do JAL, no estágio ID necessita de duas instruções NOP após o JAL.</p>
<p>2 - A execução, do JAL, no estágio EX necessita de duas instruções NOP após o JAL.</p>
<p>3 - A execução, do JAL, no estágio MEM necessita de três instruções NOP após o JAL.</p>
<p>4 - A execução, do JAL, no estágio WB não necessita de instruções NOP após o JAL.</p>
<p>5 - A instrução JAL não permite a utilização da decisão postergada para evitar os NOPs.</p>
<p>6 - A execução, do JAL, no estágio ID necessita de uma instrução NOP após o JAL e, no mínimo, uma instrução antes do JR de retorno dessa instrução.</p>
<p>7 - A execução, do JAL, no estágio EX não necessita de instruções antes do JR de retorno dessa instrução.</p>
</div>
<!--- class_panel --->
<button class="accordion">
Solução
</button>
<div class="panel">
<p>Verdadeiras: 2, 3, 6 e 7.</p>
<p>A instrução JAL chama uma subrotina que utiliza o R31 para fazer o retorno.</p>
<p>Portanto, para que o retorno possa acontecer, no clock da execução do JR, a instrução JAL (que chamou a subrotina) deve estar no estágio WB ou ter saído do pipeline.</p>
<p>O número de NOPs após o JAL é igual ao número da etapa em que ele for executado menos um.</p>
<p>É possível usar a decisão postergada com o JAL.</p>
</div>
<!--- class_panel --->
<hr />
<h2 id="ferramenta-auxiliar-conversor-binário-para-decimal-com-ou-sem-sinal">Ferramenta Auxiliar: Conversor Binário para Decimal (com ou sem sinal)</h2>
<div style="width:600px;margin:10px auto;font-family:Courier New,Courier,monospace;">
<form>
<div style="width:50%;float:left;display:inline-block;">
<label for="entrada">Valor em Binário:</label>
<textarea id="entrada" cols="32" rows="1" title="Valor em binário a ser convertido" onkeyup="validaBinario(id)" style="resize:none;">
</textarea>
</div>
<div style="width:50%;float:left;display:inline-block;">
<label for="saida">Resultado da Conversão:</label>
<textarea id="saida" cols="32" rows="1" title="Valor convertido" style="resize:none;">
</textarea>
</div>
<input type="button" value="Converter" onclick="converteBinario(entrada);"/>    <input type="checkbox" id="tiposigned" style="vertical-align:middle;">Binário com Sinal</input>
</form>
</div>
<script type="text/javascript">
function converteBinario(nome) {
tipo = document.getElementById("tiposigned").checked;
binStr = nome.value;
if (binStr === "") {
document.getElementById("saida").value = "Faltou o valor de entrada.";
}else{
if (tipo){
document.getElementById("saida").value = converteSignedDecimal(binStr);
}else{
document.getElementById("saida").value = converteUnsignedDecimal(binStr);
}
}
}
</script>
<p><br></p>
<hr />
<p><br></p>
<hr />
<hr />
<script type="text/javascript" src="../js/acordeon.js"></script>
<script src="../js/binario.js"></script>
<!-- FIM -->
</body>
</html>
